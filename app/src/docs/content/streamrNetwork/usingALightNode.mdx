import { Link } from 'react-router-dom'
import Warning from '$docs/components/Warning'
import { CodeSnippet } from '@streamr/streamr-layout'
import docsLinks from '$shared/../docsLinks'

import {
    CreateJavascriptClient,
    CreateJavaClient,
    AuthJavascriptClient,
    AuthJavaClient,
    SubscribeJavascriptClient,
    SubscribeJavaClient,
    PublishJavascriptClient,
    PublishJavaClient,
} from '$shared/snippets/streams.js'

# Using a light node

Light nodes are Streamr nodes that run locally as part of your application instance. You use it exactly like any other library: you import it to your application and interface with it using function calls.

The Streamr light node is packaged as a JavaScript library. It runs in Node.js as well as the browser. If you're developing in a programming language other than JS, <Link to={docsLinks.installingABrokerNode}>run a Broker node</Link> instead and <Link to={docsLinks.connectingApplications}>connect your application</Link> to it.

## Importing a light node

The `StreamrClient` library wraps a light node, which the library uses for publishing and subscribing to data. The library is available on `npm` as package `streamr-client`. This article contains quick usage instructions, but for more detailed instructions please refer to the [streamr-client](https://www.npmjs.com/package/streamr-client) library itself.

Install the library using `npm`:

```
npm install streamr-client
```

When using Node.js, import the library with:

```
import { StreamrClient } from 'streamr-client'
```

<Warning>

The current stable version of the Streamr Client is `5.x` (at the time of writing, December 2021) which is connected to the [Corea Network](https://streamr.network/roadmap). The Brubeck Network Streamr Client is the [6.0.0-alpha.19](https://www.npmjs.com/package/streamr-client/v/6.0.0-alpha.19) build along with the `testnet` builds of the Broker node. The developer experience of the two networks is the same, however, the `6.0.0-alpha.19` client also runs as a light node in the network, whereas the `5.x` era client communicates to a Streamr run node, remotely. When the Streamr Network transitions into the Brubeck era (ETA Jan/Feb 2022), data guarantees of `5.x` clients will need to be reassessed. Publishing data to the Brubeck network will only be visible in the [Brubeck Core UI](https://brubeck.streamr.network). The Marketplace, Core app and CLI tool are currently all configured to interact with the Corea Network only. Take care not to mix networks during this transition period.

</Warning>

Create an instance of `StreamrClient`, authenticated with an Ethereum private key:

<CodeSnippet language="javascript">{CreateJavascriptClient}</CodeSnippet>

Learn more about how Ethereum keys are used for <Link to={docsLinks.identity}>identity on Streamr</Link>.

### Subscribing to real-time messages in a stream

By subscribing to a <Link to={docsLinks.streams}>stream</Link>, your application gets immediately notified about new messages in the stream.

<CodeSnippet language="javascript">{SubscribeJavascriptClient}</CodeSnippet>

### Publishing messages to streams

When you publish messages to a stream, they get delivered by the peer-to-peer network to all subscribing nodes.

<CodeSnippet language="javascript">{PublishJavascriptClient}</CodeSnippet>

For more detailed instructions, please refer to the [streamr-client](https://www.npmjs.com/package/streamr-client) library itself.

## Staying safe

Don't share your private key to anyone. If someone gets access to it, they can publish and subscribe as you, and steal any tokens you might have in that wallet! Read more about <Link to={docsLinks.identity}>identity, keys, and wallets</Link>.
