import { Link } from 'react-router-dom'
import routes from '$routes'
import docsLinks from '$shared/../docsLinks'
import Image from '$docs/components/Image'

import MarketplaceOverview from './images/intro_to_marketplace_01_desktop.jpg'
import MarketplaceOverview2x from './images/intro_to_marketplace_01_desktop@2x.jpg'
import FreeProduct from './images/intro_to_marketplace_02_desktop.jpg'
import FreeProduct2x from './images/intro_to_marketplace_02_desktop@2x.jpg'
import PaidProduct from './images/intro_to_marketplace_03_desktop.jpg'
import PaidProduct2x from './images/intro_to_marketplace_03_desktop@2x.jpg'
import AccessPeriod from './images/intro_to_marketplace_04_desktop.jpg'
import AccessPeriod2x from './images/intro_to_marketplace_04_desktop@2x.jpg'
import SetAllowance from  './images/intro_to_marketplace_05_desktop.jpg'
import SetAllowance2x from  './images/intro_to_marketplace_05_desktop@2x.jpg'
import SetAllowanceMetamask from  './images/intro_to_marketplace_06_desktop.jpg'
import SetAllowanceMetamask2x from  './images/intro_to_marketplace_06_desktop@2x.jpg'
import CompletePurchase from  './images/intro_to_marketplace_07_desktop.jpg'
import CompletePurchase2x from  './images/intro_to_marketplace_07_desktop@2x.jpg'
import CompletePurchaseMetamask from  './images/intro_to_marketplace_08_desktop.jpg'
import CompletePurchaseMetamask2x from  './images/intro_to_marketplace_08_desktop@2x.jpg'
import TransactionComplete from './images/intro_to_marketplace_09_desktop.jpg'
import TransactionComplete2x from './images/intro_to_marketplace_09_desktop@2x.jpg'

import docsStyles from '$docs/components/DocsLayout/docsLayout.pcss'

# Introduction to the Marketplace
The <Link to={routes.marketplace.index()}>Marketplace</Link> is an application that enables users to buy and sell access to real-time data content on the Streamr Network. The Marketplace is filled with both paid and free products, offering data producers an opportunity to either monetise their data or make it freely available to everyone. Products have time-based subscription periods, and the currency used on the Marketplace is the <Link to={docsLinks.dataToken}>DATA token</Link>.

<Image
  src={MarketplaceOverview}
  highResSrc={MarketplaceOverview2x}
  alt="Marketplace Overview"
/>

The Marketplace is an <a href="https://github.com/streamr-dev/streamr-platform" target="_blank">open source</a> project that builds on the <a href="https://streamr.network/learn/network" target="_blank">Streamr Network</a> and the <a href="https://www.ethereum.org" target="_blank">Ethereum blockchain</a>. Ethereum is used to store a registry of data products, coordinate access to them, and to provide a secure ledger of value transactions. Products are published to the <a href="https://etherscan.io/address/0xa10151d088f6f2705a05d6c83719e99e079a61c1" target="_blank">Marketplace smart contract</a>, and the contract allows data buyers to directly transact with sellers using the DATA token, removing all traditionally present middlemen and their fees. All of the data on the Marketplace is delivered peer-to-peer via the Streamr Network.

## Get data from the Marketplace
Many products on the Marketplace are free. To access the streams of a free product, simply click <span className={docsStyles.streamrHighlight}>Subscribe</span> on the product page. The product will appear immediately in the Subscriptions view of Core, and the streams will be available for your use both in the Streams view of Core and also directly within any canvases you create — just search for it’s name in the Module search panel. You don't need any DATA or Ether to subscribe to a free product.

<Image
  src={FreeProduct}
  highResSrc={FreeProduct2x}
  alt="Free product"
/>

### Subscribing to paid products
Interacting with paid products requires an Ethereum wallet address, and a small amount of Ether, in order to pay the gas fees required to subscribe or publish the product. Getting access to a paid product requires a payment of DATA to the product owner.

<Image
  src={PaidProduct}
  highResSrc={PaidProduct2x}
  alt="Paid product"
/>

Clicking the <span className={docsStyles.streamrHighlight}>Subscribe</span> button initiates the subscription dialog which guides you through the contract transaction process. Gaining access to the streams inside the product happens automatically once the transaction has been completed which usually takes no longer than a few minutes. A dialog will pop up where you select the desired access period.

<Image
  src={AccessPeriod}
  highResSrc={AccessPeriod2x}
  alt="Access period"
/>

The marketplace uses smart contracts to withdraw tokens from your account. In order to allow the smart contract to execute the transfer, an allowance must be set to give permission to withdraw up to a certain amount of your tokens. This is a security measure for ERC20 tokens that means that the smart contract will only ever be able to transfer the amount of tokens that you approve.

<Image
  src={SetAllowance}
  highResSrc={SetAllowance2x}
  alt="Set allowance"
/>

To complete the the allowance step, confirm the transaction in Metamask. After setting the allowance, you will be asked to confirm the payment.

<Image
  src={SetAllowanceMetamask}
  highResSrc={SetAllowanceMetamask2x}
  alt="Set allowance Metamask"
/>

<Image
  src={CompletePurchase}
  highResSrc={CompletePurchase2x}
  alt="Complete subscription"
/>

Finally, confirm the transaction in Metamask to complete your subscription. While the transaction is being mined, you can either wait for it to complete or continue browsing the Marketplace. You will be notified after it has completed.

<Image
  src={CompletePurchaseMetamask}
  highResSrc={CompletePurchaseMetamask2x}
  alt="Complete subscription on Metamask"
/>

<Image
  src={TransactionComplete}
  highResSrc={TransactionComplete2x}
  alt="Transaction complete"
/>

Note that while you may subscribe to products with any Web3 wallet, the subscriptions will not be visible until you <Link to={docsLinks.gettingStarted}>link the account to your profile</Link>.
