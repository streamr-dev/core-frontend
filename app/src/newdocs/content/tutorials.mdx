
import { Link } from 'react-router-dom'

import Warning from '$docs/components/Warning'
import CodeSnippet from '$shared/components/CodeSnippet'
import links from '$shared/../links'
import { formatPath } from '$shared/utils/url'

import CreateStream from './images/tutorials/createStream.png'
import StreamSetup from './images/tutorials/streamSetup.png'
import GetYourAPIKey from './images/tutorials/getYourAPIKey.png'
import SettingsAPICredentials from './images/tutorials/settingsAPICredentials.png'
import Postman from './images/tutorials/postman.png'
import Example2b from './images/tutorials/example2b.png'
import Example3b from './images/tutorials/example3b.png'

import { ClientSub, ClientPub } from './code/tutorials.js'

import docsStyles from '$docs/components/DocsLayout/docsLayout.pcss'

<section id="building-a-simple-pub-sub-system">

## Building a simple pub/sub system

Before proceeding with this tutorial, we assume you have completed the following steps:

* <Link to={links.newdocs.streams}>Created your first stream</Link> 
* <Link to={links.newdocs.gettingStarted}>Got your API key or connected your Ethereum account</Link>

### Publish to a stream
The easiest way to push data to a stream is to use the one of our <Link to={links.newdocs.SDKs}>SDKs</Link>, currently available in <a target="_blank" href="https://github.com/streamr-dev/streamr-client-javascript">Javascript</a>, <a target="_blank" href="https://github.com/streamr-dev/streamr-client-java">Java</a> and a community contributed version in <a target="_blank" href="https://github.com/streamr-dev/streamr-client-python">Python</a>. Client libraries for other languages are on the roadmap.

Here is an example of publishing data to a stream using Streamr Javascript client:

<CodeSnippet language='javascript' wrapLines showLineNumbers >{ClientPub}</CodeSnippet> 

You can also try it locally in your browser. Just open this [JS Bin](https://jsbin.com/muqarukubu/edit?js,output), and replace `MY-STREAM-ID` and <kbd>MY-API-KEY</kbd> with your Stream ID and API key. Your browser will start producing data to your Stream!

Additionally, you can interact with the Streamr API using any HTTP library of your choice. You will find all the details in the <Link to={formatPath(links.newdocs.api)}>API section</Link>, but here’s a brief rundown:

You’ll be making `HTTP POST` requests to a URL, which contains your Stream ID:
<CodeSnippet language='json' wrapLines >{`https://www.streamr.com/api/v1/streams/MY-STREAM-ID/data`}</CodeSnippet>

The body of the request will be your data payload in JSON.

Add your API key to the HTTP headers as follows:

<CodeSnippet language='json' wrapLines >{`Authorization: token MY-API-KEY`}</CodeSnippet>

This is how a test request would look in the fabulous [Postman](https://www.getpostman.com/) app, with the URL and Authorization header set:

<div className={docsStyles.centered}>
  <img src={Postman} />
</div>

All the different authorization options are explained in the: <Link to={formatPath(links.newdocs.api)}>API docs</Link>

### Subscribe to data

Along with publishing data to a stream, this is best done with one of our <Link to={links.newdocs.SDKs}>SDKs</Link>. 

Here is the given example from the Streamr Javascript client [readme](https://github.com/streamr-dev/streamr-client-javascript):

<CodeSnippet language='javascript' wrapLines showLineNumbers >{ClientSub}</CodeSnippet> 

</section>
